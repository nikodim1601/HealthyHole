# Healthy Hole 

Probably the best practice solution for Healthy Hole factory monitoring systems!

## Пререквизиты

Просто склонируйте и запустите проект **"HealthyHole.WebApi: WebApi"**. Никаких дополнительных манипуляций не нужно.

## Как использовать

К проекту подключен **Swagger**, так что **API**-шку можно протестировать в браузере. 
Для экшенов я добавил документацию. Примеры запросов там тоже есть.

## Описание

Может показаться, что для такой задачи мое решение очень громоздкое и тут я согласен - это так. Но поймите и меня тоже, делать очередную АПИшку - это не интересно. Раз выпадает такой шанс, хочется отвлечься от костылестроения и сделать **супер супер-дупер клин код масштабируемую архитектуру**, для задачи, которая решается за час. Разве нет??? И Я ЕЕ СДЕЛАЛ. В соавторстве с индусами с ютьюба... 

**Sulution** состоит из 4х проектов + бонусный (не смотрите туда, просто поверьте). 

### Domain

Тут определены **сущности** и **бизнес-правила**.

### Application

Тут находится сценарии использования приложения. 

Для реализации маппинга между моделями я использовал библиотеку **AutoMapper**. 

Конечно в своем WebAPI приложении я реализовал CQRS. Тут абсолютно точно необходимо разделение на query и commands. Такое передовое приложение наверняка будет дорабатываться и тут нужна масштабируемая архитектура, а то вдруг завтра придется прикрутить кэширование и авторизацию...

Для валидации команд я использовал библиотеку **FluentValidation**.


### Dal

Этот проект ответственен за взаимодействие с БД. Я использовал EFC 5 и Sqlite. 

При построении БД я, так сказать, использовала подход Code Firs. Просто потому что это проще всего, как мне кажется.

### WebAPI

Тут находятся контроллеры с экшенами. Вся обработка команд и запросов вынесена из экшенов. 

Также как трушный ООП-програмист, неприемлющий большое количество связей между объектами, я использовал тут паттерн посредник (Реализация при помощи библиотеки MediatR). В контроллерах используется медиатор, в который передается команда с необходимыми данными, а дальше он сам ее обрабатывает посредством командхэндлеров.

## Ошибки \ Недоработки

* Я не сделал бонусную часть, похоже, останусь без премии...
* Есть баг с обработкой команд StartShift и EndShift. Когда я получаю из БД пользователя, не подтягиваются его смены. Я добавил там костыль.
* Есть баг в экшене `PersonalDepartmentController.GetAll` результат возвращает `null` в поле `Employee`, которое находится в "Сменах".
* Признаюсь сразу, я мало работал с **Entity Framework Core**, плохо спроектировал тут БД, не написал миграции.   
* Я раньше думал, что слово **employee** пишется как **emploee** и заметил это под самый конец. По этому в проекте могут встречаться орфографические ошибки, сорри :)



